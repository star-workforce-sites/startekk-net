<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Job Details | StartTekk</title>
    <meta name="description" content="Apply for this position at StartTekk">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23047857' stroke-width='2'><path stroke-linecap='round' stroke-linejoin='round' d='M13 10V3L4 14h7v7l9-11h-7z'/></svg>">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav style="background-color: #047857;" class="sticky top-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <a href="/" class="flex items-center space-x-3">
                        <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: linear-gradient(135deg, #047857 0%, #84CC16 100%);">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <div class="text-xl font-bold text-white">StarTekk</div>
                    </a>
                </div>
                <div class="hidden md:flex space-x-8">
                    <a href="/" class="text-white hover:text-lime-300 transition">Home</a>
                    <a href="/about.html" class="text-white hover:text-lime-300 transition">About</a>
                    <a href="/products.html" class="text-white hover:text-lime-300 transition">Products</a>
                    <a href="/investor" class="text-white hover:text-lime-300 transition">Investors</a>
                    <a href="/pages/jobs" class="text-lime-300 font-semibold">Jobs</a>
                    <a href="/contact.html" class="text-white hover:text-lime-300 transition">Contact</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 py-12">
        <!-- Back Button -->
        <a href="/pages/jobs" class="inline-flex items-center text-green-600 hover:text-green-700 mb-6">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Back to All Jobs
        </a>

        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Job Details (2/3 width) -->
            <div class="lg:col-span-2 space-y-6">
                <!-- Job Header -->
                <div id="jobHeader" class="bg-white p-8 rounded-lg shadow-md">
                    <!-- Loading state -->
                    <div class="animate-pulse">
                        <div class="h-8 bg-gray-200 rounded w-3/4 mb-4"></div>
                        <div class="h-6 bg-gray-200 rounded w-1/2 mb-2"></div>
                        <div class="h-6 bg-gray-200 rounded w-1/3"></div>
                    </div>
                </div>

                <!-- Job Description -->
                <div id="jobDescription" class="bg-white p-8 rounded-lg shadow-md">
                    <div class="animate-pulse space-y-4">
                        <div class="h-4 bg-gray-200 rounded"></div>
                        <div class="h-4 bg-gray-200 rounded"></div>
                        <div class="h-4 bg-gray-200 rounded w-5/6"></div>
                    </div>
                </div>

                <!-- Requirements -->
                <div id="jobRequirements" class="bg-white p-8 rounded-lg shadow-md">
                    <div class="animate-pulse space-y-4">
                        <div class="h-6 bg-gray-200 rounded w-1/4 mb-4"></div>
                        <div class="h-4 bg-gray-200 rounded"></div>
                        <div class="h-4 bg-gray-200 rounded"></div>
                    </div>
                </div>

                <!-- Responsibilities -->
                <div id="jobResponsibilities" class="bg-white p-8 rounded-lg shadow-md">
                    <div class="animate-pulse space-y-4">
                        <div class="h-6 bg-gray-200 rounded w-1/3 mb-4"></div>
                        <div class="h-4 bg-gray-200 rounded"></div>
                        <div class="h-4 bg-gray-200 rounded"></div>
                    </div>
                </div>
            </div>

            <!-- Application Form (1/3 width) -->
            <div class="lg:col-span-1">
                <div class="bg-white p-6 rounded-lg shadow-md sticky top-24">
                    <h3 class="text-2xl font-bold mb-6 text-gray-900">Apply Now</h3>
                    
                    <form id="applicationForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Full Name *</label>
                            <input type="text" id="applicant_name" required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                placeholder="John Doe">
                        </div>

                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Email *</label>
                            <input type="email" id="applicant_email" required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                placeholder="john@example.com">
                        </div>

                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Phone *</label>
                            <input type="tel" id="applicant_phone" required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                placeholder="(555) 123-4567">
                        </div>

                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">LinkedIn Profile *</label>
                            <input type="url" id="linkedin_profile" required
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                                placeholder="https://linkedin.com/in/yourprofile"
                                pattern="https://.*linkedin\.com/.*">
                            <p class="text-xs text-gray-500 mt-1">Must be a valid LinkedIn URL</p>
                        </div>

                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">Resume *</label>
                            <input type="file" id="resume" required accept=".pdf,.doc,.docx"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent">
                            <p class="text-xs text-gray-500 mt-1">PDF, DOC, or DOCX (max 5MB)</p>
                        </div>

                        <button type="submit" 
                            class="w-full bg-green-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-green-700 transition disabled:bg-gray-400 disabled:cursor-not-allowed"
                            id="submitBtn">
                            Submit Application
                        </button>

                        <p class="text-xs text-gray-500 text-center">
                            By applying, you agree to our <a href="/legal/privacy-policy.html" class="text-green-600 hover:underline">Privacy Policy</a>
                        </p>
                    </form>

                    <!-- Success Message (hidden by default) -->
                    <div id="successMessage" class="hidden mt-6 p-4 bg-green-50 border border-green-200 rounded-lg">
                        <div class="flex items-start">
                            <svg class="w-6 h-6 text-green-600 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div>
                                <h4 class="font-semibold text-green-900">Application Submitted!</h4>
                                <p class="text-sm text-green-700 mt-1">Thank you for applying. We'll review your application and get back to you soon.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Error Message (hidden by default) -->
                    <div id="errorMessage" class="hidden mt-6 p-4 bg-red-50 border border-red-200 rounded-lg">
                        <div class="flex items-start">
                            <svg class="w-6 h-6 text-red-600 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div>
                                <h4 class="font-semibold text-red-900">Error</h4>
                                <p class="text-sm text-red-700 mt-1" id="errorText"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-gray-900 to-gray-800 text-white mt-16">
        <div class="max-w-7xl mx-auto px-4 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-lg font-bold mb-4 text-green-400">Company</h3>
                    <ul class="space-y-2">
                        <li><a href="/about.html" class="text-gray-300 hover:text-green-400 transition">About Us</a></li>
                        <li><a href="/jobs" class="text-gray-300 hover:text-green-400 transition">Careers</a></li>
                        <li><a href="/contact.html" class="text-gray-300 hover:text-green-400 transition">Contact Us</a></li>
                        <li><a href="/investor" class="text-gray-300 hover:text-green-400 transition">Investor Relations</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-4 text-green-400">Products & Services</h3>
                    <ul class="space-y-2">
                        <li><a href="/investor/star-ai-cloud.html" class="text-gray-300 hover:text-green-400 transition">Star AI Cloud</a></li>
                        <li><a href="/investor/star-ai-ediscovery.html" class="text-gray-300 hover:text-green-400 transition">Star AI eDiscovery</a></li>
                        <li><a href="/investor/qr-feedback.html" class="text-gray-300 hover:text-green-400 transition">QR Feedback</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-4 text-green-400">Legal</h3>
                    <ul class="space-y-2">
                        <li><a href="/legal/privacy-policy.html" class="text-gray-300 hover:text-green-400 transition">Privacy Policy</a></li>
                        <li><a href="/legal/terms-of-service.html" class="text-gray-300 hover:text-green-400 transition">Terms of Service</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-bold mb-4 text-green-400">Contact</h3>
                    <div class="space-y-3 text-gray-300 text-sm">
                        <p><a href="tel:+14697133993" class="hover:text-green-400">(469) 713-3993</a></p>
                        <p><a href="/cdn-cgi/l/email-protection#9ef7f0f8f1deedeaffeceafbf5f5b0f0fbea" class="hover:text-green-400"><span class="__cf_email__" data-cfemail="ef86818980af9c9b8e9d9b8a8484c1818a9b">[email&#160;protected]</span></a></p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        const API_URL = '/api/jobs';
        const urlParams = new URLSearchParams(window.location.search);
        const jobId = urlParams.get('id');
        let currentJob = null;

        // Load job details on page load
        document.addEventListener('DOMContentLoaded', async () => {
            await loadJobDetails();
            setupFormHandler();
        });

        async function loadJobDetails() {
            try {
                const response = await fetch(`${API_URL}/${jobId}`);
                if (!response.ok) throw new Error('Job not found');
                
                currentJob = await response.json();
                displayJobDetails(currentJob);
            } catch (error) {
                console.error('Error loading job:', error);
                window.location.href = '/jobs';
            }
        }

        function displayJobDetails(job) {
            // Update page title
            document.getElementById('pageTitle').textContent = `${job.job_title} | StartTekk`;
            document.title = `${job.job_title} | StartTekk Careers`;

            // Job Header
            document.getElementById('jobHeader').innerHTML = `
                <h1 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">${escapeHtml(job.job_title)}</h1>
                <p class="text-xl text-gray-700 mb-4">${escapeHtml(job.company_name)}</p>
                <div class="flex flex-wrap gap-4 text-gray-600">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                        </svg>
                        ${escapeHtml(job.location)}
                    </div>
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                        </svg>
                        ${escapeHtml(job.job_type)}
                    </div>
                    <div class="flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
                        </svg>
                        ${escapeHtml(job.category)}
                    </div>
                </div>
            `;

            // Job Description
            document.getElementById('jobDescription').innerHTML = `
                <h2 class="text-2xl font-bold text-gray-900 mb-4">About This Role</h2>
                <div class="prose prose-lg max-w-none text-gray-700">
                    ${escapeHtml(job.description).split('\n').map(p => `<p class="mb-4">${p}</p>`).join('')}
                </div>
            `;

            // Requirements
            document.getElementById('jobRequirements').innerHTML = `
                <h2 class="text-2xl font-bold text-gray-900 mb-4">Requirements</h2>
                <div class="prose prose-lg max-w-none text-gray-700">
                    ${formatList(job.requirements)}
                </div>
            `;

            // Responsibilities
            if (job.responsibilities) {
                document.getElementById('jobResponsibilities').innerHTML = `
                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Responsibilities</h2>
                    <div class="prose prose-lg max-w-none text-gray-700">
                        ${formatList(job.responsibilities)}
                    </div>
                `;
            }
        }

        function formatList(text) {
            const items = text.split(/[.â€¢\n]/).filter(item => item.trim());
            return `<ul class="list-disc list-inside space-y-2">
                ${items.map(item => `<li>${escapeHtml(item.trim())}</li>`).join('')}
            </ul>`;
        }

        function setupFormHandler() {
            document.getElementById('applicationForm').addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const submitBtn = document.getElementById('submitBtn');
                const successMsg = document.getElementById('successMessage');
                const errorMsg = document.getElementById('errorMessage');
                
                // Hide messages
                successMsg.classList.add('hidden');
                errorMsg.classList.add('hidden');
                
                // Disable submit button
                submitBtn.disabled = true;
                submitBtn.textContent = 'Submitting...';
                
                try {
                    // Validate LinkedIn URL
                    const linkedinUrl = document.getElementById('linkedin_profile').value;
                    if (!linkedinUrl.includes('linkedin.com')) {
                        throw new Error('Please enter a valid LinkedIn profile URL');
                    }
                    
                    // Get form data
                    const formData = new FormData();
                    formData.append('applicant_name', document.getElementById('applicant_name').value);
                    formData.append('applicant_email', document.getElementById('applicant_email').value);
                    formData.append('applicant_phone', document.getElementById('applicant_phone').value);
                    formData.append('linkedin_profile', linkedinUrl);
                    formData.append('resume', document.getElementById('resume').files[0]);
                    
                    // Submit application
                    const response = await fetch(`${API_URL}/${jobId}/apply`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        const error = await response.json();
                        throw new Error(error.message || 'Failed to submit application');
                    }
                    
                    // Show success message
                    successMsg.classList.remove('hidden');
                    document.getElementById('applicationForm').reset();
                    
                    // Scroll to success message
                    successMsg.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                    
                } catch (error) {
                    // Show error message
                    document.getElementById('errorText').textContent = error.message;
                    errorMsg.classList.remove('hidden');
                    errorMsg.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                } finally {
                    // Re-enable submit button
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'Submit Application';
       