<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT Outsourcing Cost Calculator | Compare Offshore Development Rates | Startekk</title>
    <meta name="description" content="Calculate your savings with offshore development. Compare rates for 238+ IT roles across USA, Nearshore, and Offshore locations.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'emerald': { 600: '#047857', 700: '#065f46' },
                        'lime': { 500: '#84CC16', 600: '#65a30d' }
                    }
                }
            }
        }
    </script>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-8BFZG3R9ZR"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-8BFZG3R9ZR');
    </script>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-emerald-600 sticky top-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-lg flex items-center justify-center" style="background: linear-gradient(135deg, #047857 0%, #84CC16 100%);">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                    </div>
                    <div class="text-xl font-bold text-white">Startekk</div>
                </div>
                <div class="hidden md:flex items-center space-x-6">
                    <a href="/index.html" class="text-white hover:text-lime-300 transition-colors">Home</a>
                    <a href="/about.html" class="text-white hover:text-lime-300 transition-colors">About</a>
                    <a href="/products.html" class="text-white hover:text-lime-300 transition-colors">Products</a>
                    <a href="/services.html" class="text-white hover:text-lime-300 transition-colors">Services</a>
                    <a href="/pages/jobs.html" class="text-white hover:text-lime-300 transition-colors">Jobs</a>
                    <a href="/investor/index.html" class="text-white hover:text-lime-300 transition-colors">Investors</a>
                    <a href="/contact.html" class="px-4 py-2 rounded-lg font-semibold" style="background: linear-gradient(135deg, #84CC16 0%, #047857 100%); color: white;">Contact Us</a>
                </div>
                
                <!-- Mobile menu button -->
                <button id="mobile-menu-button" class="md:hidden text-white">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Mobile menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-emerald-700">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="/index.html" class="block px-3 py-2 text-white hover:bg-emerald-600 rounded">Home</a>
                <a href="/about.html" class="block px-3 py-2 text-white hover:bg-emerald-600 rounded">About</a>
                <a href="/products.html" class="block px-3 py-2 text-white hover:bg-emerald-600 rounded">Products</a>
                <a href="/services.html" class="block px-3 py-2 text-white hover:bg-emerald-600 rounded">Services</a>
                <a href="/pages/jobs.html" class="block px-3 py-2 text-white hover:bg-emerald-600 rounded">Jobs</a>
                <a href="/investor/index.html" class="block px-3 py-2 text-white hover:bg-emerald-600 rounded">Investors</a>
                <a href="/contact.html" class="block px-3 py-2 text-white hover:bg-emerald-600 rounded">Contact Us</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="bg-gradient-to-r from-emerald-600 to-lime-500 text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h1 class="text-4xl md:text-5xl font-bold mb-4">IT Outsourcing Cost Calculator</h1>
            <p class="text-xl md:text-2xl mb-2">Calculate your savings with offshore development. Compare rates for 238+ IT roles across USA, Nearshore, and Offshore locations.</p>
        </div>
    </div>

    <!-- Calculator Section -->
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="bg-white rounded-xl shadow-xl p-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-8">Calculate Your Savings</h2>
            
            <form id="calculator-form" class="space-y-6">
                <!-- Job Title Search -->
                <div class="relative">
                    <label for="job-search" class="block text-sm font-semibold text-gray-900 mb-2">
                        Search Job Title
                    </label>
                    <input 
                        type="text" 
                        id="job-search" 
                        placeholder="Start typing (e.g., Software Engineer, Architect...)"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                        autocomplete="off"
                    />
                    <div id="job-suggestions" class="hidden absolute left-0 right-0 mt-2 border border-gray-200 rounded-lg shadow-lg bg-white max-h-64 overflow-y-auto z-50"></div>
                    <p class="mt-2 text-sm text-gray-600" id="jobs-count">Loading jobs...</p>
                    <input type="hidden" id="selected-job-id" />
                </div>

                <!-- Team Size -->
                <div>
                    <label for="team-size" class="block text-sm font-semibold text-gray-900 mb-2">
                        Team Size
                    </label>
                    <input 
                        type="number" 
                        id="team-size" 
                        min="1" 
                        value="5"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                    />
                </div>

                <!-- Hours Per Week -->
                <div>
                    <label for="hours-week" class="block text-sm font-semibold text-gray-900 mb-2">
                        Hours Per Week (per person)
                    </label>
                    <select 
                        id="hours-week"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                    >
                        <option value="40" selected>40 hours (Full-time)</option>
                        <option value="30">30 hours</option>
                        <option value="20">20 hours (Part-time)</option>
                    </select>
                </div>

                <!-- Compare Against -->
                <div>
                    <label for="location-select" class="block text-sm font-semibold text-gray-900 mb-2">
                        Compare Against
                    </label>
                    <select 
                        id="location-select"
                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                    >
                        <option value="customer">Onsite - USA Customer</option>
                        <option value="startekk" selected>Onsite - USA with Startekk</option>
                        <option value="nearshore">Nearshore Mexico/Canada</option>
                        <option value="offshore">Offshore - India</option>
                    </select>
                </div>

                <button 
                    type="submit"
                    id="calculate-btn"
                    class="w-full bg-gradient-to-r from-emerald-600 to-lime-500 text-white py-4 px-6 rounded-lg font-bold text-lg hover:shadow-lg transition-all"
                >
                    Calculate Savings
                </button>
            </form>
        </div>

        <!-- Results Section -->
        <div id="results-section" class="hidden mt-8 space-y-6">
            <!-- Annual Savings Card -->
            <div class="bg-gradient-to-r from-emerald-600 to-lime-500 rounded-xl shadow-xl p-8 text-white">
                <h3 class="text-xl font-semibold mb-4">Your Annual Savings</h3>
                <div class="text-5xl font-bold mb-2" id="annual-savings">$0</div>
                <div class="text-xl mb-4" id="savings-percentage">0% cost reduction</div>
                <div class="text-lg" id="five-year-savings">5-Year Savings: $0</div>
            </div>

            <!-- Rate Comparison -->
            <div class="bg-white rounded-xl shadow-xl p-8">
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="border-2 border-gray-200 rounded-lg p-6">
                        <h4 class="text-sm font-semibold text-gray-600 mb-2">Onsite - USA Customer</h4>
                        <div class="text-3xl font-bold text-gray-900" id="market-rate">$0</div>
                        <div class="text-sm text-gray-600 mt-1">Annual cost</div>
                    </div>
                    <div class="border-2 border-emerald-500 rounded-lg p-6 bg-emerald-50">
                        <h4 class="text-sm font-semibold text-emerald-700 mb-2" id="selected-label">Your Selected Model</h4>
                        <div class="text-3xl font-bold text-emerald-700" id="selected-rate">$0</div>
                        <div class="text-sm text-emerald-600 mt-1">Annual cost</div>
                    </div>
                </div>
            </div>

            <!-- All Options Comparison -->
            <div class="bg-white rounded-xl shadow-xl p-8">
                <h3 class="text-2xl font-bold text-gray-900 mb-6">Compare All Options</h3>
                <div id="all-options" class="space-y-4"></div>
            </div>

            <!-- CTA -->
            <div class="bg-gray-100 rounded-xl p-8 text-center">
                <h3 class="text-2xl font-bold text-gray-900 mb-4">Ready to start saving?</h3>
                <p class="text-gray-600 mb-6">Let's discuss how Startekk can help reduce your costs</p>
                <a href="/contact.html" class="inline-block bg-gradient-to-r from-emerald-600 to-lime-500 text-white py-3 px-8 rounded-lg font-bold hover:shadow-lg transition-all">
                    Contact Us Today
                </a>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-lg font-semibold mb-4">Company</h3>
                    <ul class="space-y-2">
                        <li><a href="/about.html" class="hover:text-lime-300">About Us</a></li>
                        <li><a href="/blog.html" class="hover:text-lime-300">Blog</a></li>
                        <li><a href="/case-studies.html" class="hover:text-lime-300">Case Studies</a></li>
                        <li><a href="/pages/jobs.html" class="hover:text-lime-300">Jobs</a></li>
                        <li><a href="/contact.html" class="hover:text-lime-300">Contact</a></li>
                        <li><a href="/investor/index.html" class="hover:text-lime-300">Investors</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Products</h3>
                    <ul class="space-y-2">
                        <li><a href="/star-ai-cloud.html" class="hover:text-lime-300">Star AI Cloud</a></li>
                        <li><a href="/star-ai-ediscovery.html" class="hover:text-lime-300">Star AI eDiscovery</a></li>
                        <li><a href="/star-ai-finance.html" class="hover:text-lime-300">Star AI Finance</a></li>
                        <li><a href="/star-automation.html" class="hover:text-lime-300">Star Automation</a></li>
                        <li><a href="/qr-feedback.html" class="hover:text-lime-300">QR Feedback</a></li>
                        <li><a href="/cost-calculator.html" class="hover:text-lime-300">Cost Calculator</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Services</h3>
                    <ul class="space-y-2">
                        <li><a href="/services.html" class="hover:text-lime-300">Software Development</a></li>
                        <li><a href="/services.html" class="hover:text-lime-300">Cloud Solutions</a></li>
                        <li><a href="/services.html" class="hover:text-lime-300">AI & ML Services</a></li>
                        <li><a href="https://starworkforce.net" class="hover:text-lime-300">Technology Staffing â†’</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-4">Legal</h3>
                    <ul class="space-y-2">
                        <li><a href="/legal/privacy-policy.html" class="hover:text-lime-300">Privacy Policy</a></li>
                        <li><a href="/legal/terms-of-service.html" class="hover:text-lime-300">Terms of Service</a></li>
                        <li><a href="/legal/cookie-policy.html" class="hover:text-lime-300">Cookie Policy</a></li>
                        <li><a href="/legal/accessibility.html" class="hover:text-lime-300">Accessibility</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-8 pt-8 text-center text-gray-400">
                <p>Â© 2025 Startekk, LLC. All rights reserved.</p>
                <p class="mt-2">
                    <a href="tel:+14697133993" class="hover:text-lime-300">(469) 713-3993</a> |
                    5465 Legacy Drive Suite 650, Plano, TX 75024
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Global state
        let allJobs = [];
        let selectedJob = null;

        // Tier labels (CORRECTED)
        const TIER_LABELS = {
            customer: 'Onsite - USA Customer',
            startekk: 'Onsite - USA with Startekk',
            nearshore: 'Nearshore Mexico/Canada',
            offshore: 'Offshore - India'
        };

        // Load all jobs on page load
        async function loadJobs() {
            try {
                const response = await fetch('/api/calculator/jobs');
                if (!response.ok) throw new Error('API not available');
                
                const jobs = await response.json();
                if (!jobs || jobs.length === 0) throw new Error('No jobs returned');
                
                allJobs = jobs;
                console.log(`âœ… Loaded ${allJobs.length} jobs`);
                document.getElementById('jobs-count').textContent = `${allJobs.length} job titles available`;
                
            } catch (error) {
                console.error('Error loading jobs:', error);
                document.getElementById('jobs-count').textContent = 'Error loading jobs. Please refresh the page.';
            }
        }

        // Search jobs as user types
        const jobSearch = document.getElementById('job-search');
        const jobSuggestions = document.getElementById('job-suggestions');
        let searchTimeout;

        jobSearch.addEventListener('input', (e) => {
            const query = e.target.value.trim();
            
            if (query.length < 2) {
                jobSuggestions.classList.add('hidden');
                return;
            }

            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                searchJobs(query);
            }, 300);
        });

        function searchJobs(query) {
            const queryLower = query.toLowerCase();
            const filtered = allJobs.filter(job => 
                job.job_title.toLowerCase().includes(queryLower)
            ).slice(0, 20);
            
            displaySuggestions(filtered);
        }

        function displaySuggestions(jobs) {
            if (jobs.length === 0) {
                jobSuggestions.innerHTML = '<div class="p-4 text-gray-500">No jobs found</div>';
                jobSuggestions.classList.remove('hidden');
                return;
            }

            jobSuggestions.innerHTML = jobs.map(job => `
                <div class="p-3 hover:bg-gray-100 cursor-pointer border-b last:border-b-0" data-job-id="${job.id}">
                    <div class="font-semibold text-gray-900">${job.job_title}</div>
                    <div class="text-sm text-gray-600">${job.category || ''} ${job.seniority ? 'â€¢ ' + job.seniority : ''}</div>
                </div>
            `).join('');

            jobSuggestions.classList.remove('hidden');

            // Add click handlers
            jobSuggestions.querySelectorAll('[data-job-id]').forEach(el => {
                el.addEventListener('click', () => {
                    const jobId = parseInt(el.dataset.jobId);
                    selectedJob = jobs.find(j => j.id === jobId);
                    jobSearch.value = selectedJob.job_title;
                    document.getElementById('selected-job-id').value = selectedJob.id;
                    jobSuggestions.classList.add('hidden');
                    console.log('âœ… Selected job:', selectedJob.job_title);
                });
            });
        }

        // Close suggestions when clicking outside
        document.addEventListener('click', (e) => {
            if (!jobSearch.contains(e.target) && !jobSuggestions.contains(e.target)) {
                jobSuggestions.classList.add('hidden');
            }
        });

        // Calculate savings - FIXED VERSION
        document.getElementById('calculator-form').addEventListener('submit', (e) => {
            e.preventDefault();
            
            console.log('ðŸ”˜ Calculate button clicked');
            
            // If no job selected from suggestions, try to find match by text
            if (!selectedJob) {
                const searchText = jobSearch.value.trim();
                if (searchText) {
                    selectedJob = allJobs.find(j => 
                        j.job_title.toLowerCase() === searchText.toLowerCase()
                    );
                }
            }

            if (!selectedJob) {
                alert('Please select a job title from the suggestions list');
                jobSearch.focus();
                return;
            }

            const teamSize = parseInt(document.getElementById('team-size').value);
            const hoursPerWeek = parseInt(document.getElementById('hours-week').value);
            const location = document.getElementById('location-select').value;
            
            console.log('ðŸ“Š Calculating:', {
                job: selectedJob.job_title,
                team: teamSize,
                hours: hoursPerWeek,
                location: location
            });

            calculateAndDisplay(selectedJob, teamSize, hoursPerWeek, location);
        });

        function calculateAndDisplay(job, teamSize, hoursPerWeek, location) {
            console.log('ðŸ’° Starting calculation...');
            
            // Map database columns to tier keys with parseFloat
            const rates = {
                customer: parseFloat(job.usa_market_rate),
                startekk: parseFloat(job.usa_startekk_onsite),
                nearshore: parseFloat(job.canada_rate_nearshore),
                offshore: parseFloat(job.india_rate_offshore)
            };
            
            console.log('ðŸ’µ Rates:', rates);

            const selectedRate = rates[location];
            const customerRate = rates.customer;

            // Calculate costs
            const hoursPerYear = hoursPerWeek * 52;
            const customerAnnual = customerRate * hoursPerYear * teamSize;
            const selectedAnnual = selectedRate * hoursPerYear * teamSize;
            const annualSavings = customerAnnual - selectedAnnual;
            const savingsPercent = ((annualSavings / customerAnnual) * 100).toFixed(1);
            const fiveYearSavings = annualSavings * 5;

            console.log('âœ… Calculated savings:', formatCurrency(annualSavings));

            // Update selected label
            document.getElementById('selected-label').textContent = TIER_LABELS[location];

            // Display results
            document.getElementById('annual-savings').textContent = formatCurrency(annualSavings);
            document.getElementById('savings-percentage').textContent = `${savingsPercent}% cost reduction`;
            document.getElementById('five-year-savings').textContent = `5-Year Savings: ${formatCurrency(fiveYearSavings)}`;
            document.getElementById('market-rate').textContent = formatCurrency(customerAnnual);
            document.getElementById('selected-rate').textContent = formatCurrency(selectedAnnual);

            // Display all options
            const options = [
                { label: TIER_LABELS.customer, value: rates.customer, key: 'customer' },
                { label: TIER_LABELS.startekk, value: rates.startekk, key: 'startekk' },
                { label: TIER_LABELS.nearshore, value: rates.nearshore, key: 'nearshore' },
                { label: TIER_LABELS.offshore, value: rates.offshore, key: 'offshore' }
            ];

            document.getElementById('all-options').innerHTML = options.map(opt => {
                const annual = opt.value * hoursPerYear * teamSize;
                const savings = customerAnnual - annual;
                const percent = ((savings / customerAnnual) * 100).toFixed(1);
                const isSelected = opt.key === location;

                return `
                    <div class="p-4 rounded-lg ${isSelected ? 'bg-emerald-50 border-2 border-emerald-500' : 'bg-gray-50 border border-gray-200'}">
                        <div class="flex justify-between items-center">
                            <div>
                                <div class="font-semibold text-gray-900">${opt.label} ${isSelected ? 'âœ“' : ''}</div>
                                <div class="text-sm text-gray-600">$${opt.value.toFixed(2)}/hr per person</div>
                            </div>
                            <div class="text-right">
                                <div class="text-2xl font-bold ${isSelected ? 'text-emerald-700' : 'text-gray-900'}">${formatCurrency(annual)}</div>
                                <div class="text-sm ${isSelected ? 'text-emerald-600' : 'text-gray-600'}">
                                    ${savings > 0 ? `Save ${formatCurrency(savings)} (${percent}%)` : 'Baseline'}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Show results
            document.getElementById('results-section').classList.remove('hidden');
            document.getElementById('results-section').scrollIntoView({ behavior: 'smooth', block: 'nearest' });

            // Track in GA
            if (typeof gtag !== 'undefined') {
                gtag('event', 'calculate_savings', {
                    'job_title': job.job_title,
                    'location': location,
                    'annual_savings': annualSavings
                });
            }
            
            console.log('âœ… Results displayed');
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                maximumFractionDigits: 0
            }).format(amount);
        }

        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        if (mobileMenuButton) {
            mobileMenuButton.addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.toggle('hidden');
            });
        }

        // Initialize
        console.log('ðŸš€ Initializing calculator...');
        loadJobs();
    </script>
</body>
</html>